# Документація API адрес магазину

## Ендпоїнти

### 1. Отримання JWT токена
- **Метод:** `POST`
- **URL:** `{{url}}/api/sync/auth/login`
- **Тіло запиту (JSON):**
  ```json
  {
    "email": "testapi@test.com",
    "password": "somesecret"
  }
  ```
- **Опис:**  
  Використовується для аутентифікації. Повертає JWT токен для доступу до інших ендпоїнтів.

---

### 2. Оновлення JWT токена
- **Метод:** `POST`
- **URL:** `{{url}}/api/sync/auth/refresh`
- **Заголовок:**  
  `Authorization: Bearer <JWT_TOKEN>`
- **Опис:**  
  Генерує новий JWT токен на основі поточного (якщо він ще дійсний).
  
---

### 3. Оновлення адрес магазину
- **Метод:** `POST`
- **URL:** `{{url}}/api/sync/addresses/update`
- **Заголовок:**  
  `Authorization: Bearer <JWT_TOKEN>`
- **Тіло запиту (JSON):**  
  Див. [приклад у файлі колекції](https://github.com/KewinKos/kewinkos.github.io/blob/main/Sync%20API.postman_collection.json) (поля `shop` - назва магазину так, як вона збережена в інформаційній системі GoToShop, `addresses` - масив елементів адрес, що представлені полями: `lat`, `lon`, `city`, `regionName`, `address`, переклади).
- **Опис:**  
  Оновлює адреси магазину. Поле `addresses` має містити всі актуальні адреси магазину.

---

## Валідація даних

### Правила для даних адрес
| Поле                          | Тип даних       | Обмеження                   | Обов'язкове? |
|-------------------------------|-----------------|---------------------------- |--------------|
| `shop`                        | Рядок           | Максимум 255 символів       | Так          |
| `addresses`                     | Масив об’єктів  | Мінімум 1 елемент           | Так          |
| `addresses.*.lat`               | Число           | Діапазон: -90.00 - 90.00    | Так          |
| `addresses.*.lon`               | Число           | Діапазон: -180.00 - 180.00  | Так          |
| `addresses.*.{lang}.city`       | Рядок           | Максимум 255 символів       | Так          |
| `addresses.*.{lang}.regionName` | Рядок           | Максимум 255 символів       | Так          |
| `addresses.*.{lang}.address`    | Рядок           | Максимум 255 символів       | Так          |

### Переклади (наприклад, `uk`, `ru`)
| Поле         | Тип даних | Обмеження              | Обов'язкове? |
|--------------|-----------|------------------------|--------------|
| `city`       | Рядок     | Максимум 255 символів  | Так          |
| `regionName` | Рядок     | Максимум 255 символів  | Ні           |
| `address`    | Рядок     | Максимум 255 символів  | Ні           |

## Приклади помилок валідації
- Відсутнє обов'язкове поле: The `lat` field is required.
- Невірний формат географічної широти: The `lat` field must be between -90 and 90.
- Невірний формат географічної довготи: The `lon` field must be between -180 and 180.
- Перевищення довжини рядка: The `city` field must not be greater than 255 characters.

## Приклад JSON
```
{
    "shop": "ShopName",
    "addresses": [
        {
        "lat": 50.504517,
        "lon": 30.831982,
        "uk": {
            "city": "м. Бровари",
            "regionName": "Київська обл.",
            "address": "вул. Москаленка Сергія, 39"
        },
        "ru": {
            "city": "м. Бровари",
            "regionName": "Київська обл.",
            "address": "вул. Москаленка Сергія, 39"
        }
    },
    {
        "lat": 50.596159,
        "lon": 30.451334,
        "uk": {
            "city": "м. Вишгород",
            "regionName": "Київська обл.",
            "address": "вул. Ягідна, 5-А"
        },
        "ru": {
            "city": "м. Вишгород",
            "regionName": "Київська обл.",
            "address": "вул. Ягідна, 5-А"
        }
    }
    ]
}
```